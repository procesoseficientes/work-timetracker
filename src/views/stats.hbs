<h2>Stats</h2>

<form id="filter">
  <input type="hidden" id="page" name="page" value="{{page}}"/>
</form>

<form method="POST">
  <div class="form-group">
    <label for="owner">Task owner</label>
    <select name="owner" class="form-control bg-dark text-light">
      {{#each owners}}
        <option value="{{this.id}}">{{this.name}}</option>
      {{/each}}
    </select>
  </div>

  <div class="form-group">
    <label for="name">Project name</label>
    <input type="text" class="form-control bg-dark text-light" name="name" placeholder="Enter name">
  </div>

  <div class="form-group">
    <label for="name">Hours budget</label>
    <input min="1" type="number" class="form-control bg-dark text-light" name="budget" placeholder="Enter budget in hours">
  </div>

  <div class="form-group">
    <label for="name">Description</label>
    <input type="text" class="form-control bg-dark text-light" name="description" placeholder="Enter description">
  </div>

  <button type="submit" class="btn btn-primary">Submit</button>
</form>
<br>

{{#each projects}}
  <hr/>
  <h6>{{this.name}}</h6>
  <label>{{this.hours}}h - {{this.description}}</label>
  <div class="progress" style="height: 35px;">
    {{#each this.times}}
    <div 
      class="progress-bar {{this.color}}" 
      role="progressbar" 
      style="width: {{this.percent}}%" 
      aria-valuenow="20" 
      aria-valuemin="0" 
      aria-valuemax="100"
    >
      {{this.user}} ({{this.hours}}h)
    </div>
    {{/each}}
  </div>
  <br/>
{{/each}}

<ul class="pagination">
  {{#if showPrevious}}<li onclick="pagination(-1)" class="page-item bg-dark"><a class="page-link bg-dark text-light">Previous</a></li>{{/if}}
  {{#if showNext}}<li onclick="pagination(1)" class="page-item bg-dark"><a class="page-link bg-dark text-light">Next</a></li>{{/if}}
</ul>

<script>
  function pagination (direction) {
    const newPage = parseInt($('#page').val()) + direction
    $('#page').val(newPage > 0 ? newPage : 0)
    $('#filter').submit()
  }
</script>