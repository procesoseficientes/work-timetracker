<h2>Track</h2>
<form method="POST">
  <div class="form-group">
    <label for="owner">Task owner</label>
    <select onchange="toggleProject(); loadProject()" name="owner" class="form-control bg-dark text-light">
      {{#each owners}}
        <option value="{{this.id}}">{{this.name}}</option>
      {{/each}}
      <option value="0">You (lunch/break)</option>
    </select>
  </div>

  <div id="project-container" class="form-group">
    <label for="project">Project</label>
    <select id="project" name="project" class="form-control bg-dark text-light">
    </select>
  </div>

  <div class="form-group">
    <label for="task">Task</label>
    <input type="text" class="form-control bg-dark text-light" name="task" placeholder="Enter task">
  </div>

  <button type="submit" class="btn btn-primary">Track</button>
  <button class="btn btn-danger">Stop Tracking</button>
</form>

<br/>

<h2>Timeline</h2>
<div class="progress" style="height: 35px;">
  <div class="progress-bar" role="progressbar" style="width: 15%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100">Ferco</div>
  <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">Lunch</div>
  <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">Arium</div>
</div>

<script>
  function toggleProject() {
    const owner = document.getElementsByName('owner')[0].value
    
    if (owner === '0') {
      document.getElementById('project-container').classList.add('hidden')
    } else {
      document.getElementById('project-container').classList.remove('hidden')
    }
  }

  function loadProject() {
    const owner = document.getElementsByName('owner')[0].value
    fetch(`/projects/json?id=${owner}`).then(async data => {
      data = await data.json()
      let projectsOption = data.reduce((a, b) => {
        return a + `<option value="${b.id}">${b.name}</option>`
      }, '')

      console.log(projectsOption)

      document.getElementById('project').innerHTML = projectsOption
    })
  }

  loadProject()
</script>